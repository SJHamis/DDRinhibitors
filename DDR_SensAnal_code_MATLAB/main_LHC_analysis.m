% %1: time
% %2:(sd+termina)[% of cycling], 3:(sd+terminal)[% of all]
% %4:g1+s+sd+g2m 5:(3)+g0 6:(4)+terminal 
% %7:g1, 8:s, 9:sd, 10:g2m, 11:g0, 12:dead

close all;
clear all;

for i =1:100;
   sample{i} = importdata(sprintf('SensitivityAnalysisDataLHC/lhc__sample_%d',i) );
end;

no_lhc_samples=100;
no_runs=100;

X1=zeros(no_lhc_samples,no_runs); %each row corresponds to one sample. 
X2=zeros(no_lhc_samples,no_runs); %col corresponds to the no_runs different end results

%6 7 10 11 44
sample{6}=sample{1};
sample{7}=sample{1};
sample{10}=sample{1};
sample{11}=sample{1};
sample{44}=sample{1};

for i = 1:no_lhc_samples
    A_temp=sample{i};
    dp=1; %dummy variable
    %i
    for j = 73:73:7300 
        X1(i,dp) = A_temp(j,2); %2 is damage
        X2(i,dp) = A_temp(j,6); % 6 is cellcount
        dp=dp+1;

    end     %row says which row. Col says from which experiment
end



X1_medians=median(X1,2);
X2_medians=median(X2,2);
% 
no_variables=7;
variable_values=zeros(no_variables,no_lhc_samples);
variable_values(1,:)=0.001*[23396,22786,24660,22715,22481,22344,25361,22375,23422,24990,25593,22176,24354,23344,22814,25452,24422,25349,23317,25739,22418,24368,24616,22100,25298,25822,25029,24087,24461,23534,22616,23195,24550,23867,25558,24771,24488,23681,24036,23132,25915,22227,23823,22279,25495,25620,22946,24080,24572,23786,22281,24847,25103,24737,24801,23243,24698,25403,25650,25041,23983,25153,23085,22121,25926,23958,22672,23487,23747,24284,25195,23002,23471,22478,24216,25204,25767,22523,22984,23218,24134,22914,23565,23664,24888,25273,24920,22846,22047,25864,22037,24176,22560,24263,25714,23885,22753,23640,23045,25961];
variable_values(2,:)=0.001*[893,673,245,524,759,63,742,432,139,81,876,447,860,389,502,76,769,110,93,552,960,404,490,785,588,454,466,314,652,102,516,903,309,262,573,730,645,921,278,391,298,208,362,952,163,622,149,218,808,195,351,254,857,23,669,187,734,48,978,371,821,238,17,567,38,608,632,773,495,474,287,227,841,179,127,541,719,342,709,321,813,699,336,54,594,887,943,416,912,533,931,9,427,620,795,980,840,995,686,152];
variable_values(3,:)=[65,84,67,76,80,75,74,79,71,73,81,77,85,83,84,76,65,72,82,69,81,78,68,85,70,75,65,77,73,69,83,81,79,71,66,67,79,75,74,76,81,80,68,75,66,82,82,82,78,79,72,80,71,68,81,85,78,66,81,83,67,83,82,70,73,68,84,69,75,73,77,76,68,74,74,73,77,67,70,72,70,69,80,71,76,67,83,72,77,84,75,66,72,67,80,73,69,79,78,71];
variable_values(4,:)=[0.0311,0.0407,0.0301,0.0457,0.0275,0.0415,0.0116,0.0105,0.0346,0.0451,0.0342,0.0470,0.0257,0.0247,0.0397,0.0139,0.0492,0.0208,0.0142,0.0411,0.0151,0.0436,0.0419,0.0121,0.0485,0.0374,0.0223,0.0206,0.0325,0.0339,0.0165,0.0354,0.0290,0.0134,0.0147,0.0186,0.0224,0.0421,0.0248,0.0334,0.0367,0.0253,0.0499,0.0387,0.0358,0.0269,0.0171,0.0189,0.0111,0.0426,0.0156,0.0175,0.0113,0.0430,0.0182,0.0196,0.0395,0.0384,0.0197,0.0282,0.0349,0.0314,0.0475,0.0462,0.0388,0.0126,0.0241,0.0160,0.0131,0.0217,0.0491,0.0294,0.0178,0.0401,0.0483,0.0321,0.0477,0.0467,0.0330,0.0264,0.0368,0.0213,0.0263,0.0437,0.0203,0.0162,0.0453,0.0101,0.0444,0.0298,0.0278,0.0286,0.0239,0.0307,0.0234,0.0228,0.0446,0.0316,0.0364,0.0378];
variable_values(5,:)=[0.720,0.980,1.16,0.940,1.18,0.530,1.05,1.09,1.45,1.47,0.990,0.840,0.510,0.890,1.03,0.610,0.710,1.20,1.42,1.38,0.890,0.530,0.760,1.21,1.11,0.810,0.910,1.17,1.37,1.28,0.690,0.750,0.730,0.780,1.41,1.31,1.03,1.01,0.540,0.990,0.790,0.910,0.690,1.31,0.850,1.23,1.24,1.06,1.11,1.33,1.43,1.50,0.520,0.560,1.48,0.940,1.14,1.13,0.960,1.09,0.930,1.38,1.14,0.670,1.28,0.630,0.800,0.650,0.950,1.22,1.47,0.760,0.850,1.19,1.27,0.820,0.710,1.08,0.810,1,0.570,1.45,0.670,1.06,1.34,0.880,1.19,0.600,0.570,0.590,1.41,1.35,0.860,1.29,1.39,0.580,1.26,1.35,0.650,0.630];
variable_values(6,:)=[2.37,2.48,1.12,2.93,1.31,1.04,2.45,2.70,2.11,2.75,2.63,1.56,1.33,2.14,2.89,2.49,1.07,2.97,2.30,2.60,1.91,1.29,1.11,2.77,1.18,2.22,1.53,1.23,1.21,1.76,2.35,1.82,1.72,1.60,1.93,2.92,1.98,1.08,1.85,2.67,2.18,2.25,1.63,2.83,1.51,1.83,1,2.09,2.01,2.95,1.77,1.59,1.25,1.43,2.87,2.60,2.72,2.71,1.67,2.51,1.88,2.54,2.65,2.56,2.42,1.45,2.82,2.06,1.37,1.14,2.29,1.40,1.35,1.98,2.99,1.95,2.80,2.15,1.79,1.74,1.50,2.26,1.58,1.28,1.89,1.69,2.40,2.21,2.85,2.08,2.43,1.17,1.06,1.39,1.47,2.19,2.03,2.55,2.33,1.65];
variable_values(7,:)=[1.37,1.42,1.17,0.980,1.44,1.15,1.33,0.710,1.41,0.680,0.590,0.810,0.890,0.550,0.730,0.870,1.23,1.39,0.900,0.960,0.660,1.35,0.750,0.500,1.46,1.47,1.28,0.720,0.640,0.770,1.16,1.45,0.990,0.820,0.510,0.570,1.36,0.620,1.21,1.17,0.730,0.960,1.28,1.25,1.26,1.04,0.760,1.11,1.09,0.920,0.670,1.06,0.660,1.38,1.20,1.44,1.06,0.810,0.750,0.860,0.930,1.50,0.650,1.31,0.790,1.41,1,1.48,0.550,1.11,0.520,0.840,1.02,0.700,1.13,1.03,1.26,0.600,0.890,0.610,1.03,1,1.32,1.07,1.31,1.22,0.540,0.580,0.830,1.08,0.590,1.12,1.19,0.920,0.780,1.38,0.940,1.19,0.870,1.30];

for i = 1:no_variables
%i=7;
    figure
    set(gcf, 'Position',  [100, 100, 1000, 420])

    box on
    ax = gca;               % get the current axis
    ax.Clipping = 'off'; 
    subplot(1,2,1)
    box on
    for j = 1:no_lhc_samples    
        hold on
        plot(variable_values(i,j), X1_medians(j), 'o','markeredgecolor', [0.1 0.1 0.7],'MarkerSize', 9)
        ylabel('\gammaH2AX (%)','FontSize', 14);
        if(i==1)
            xlabel('\mu (hours)','FontSize', 14);
        elseif(i==2)
            xlabel('\sigma (hours)','FontSize', 14);
        elseif(i==3)
            xlabel('\Pi_{D-S} (%)','FontSize', 14);
        elseif (j==4)
            xlabel('\Theta_{D-S}','FontSize', 14);
        elseif(i==5)
            xlabel('EC_{50} (\muM)','FontSize', 14);
        elseif(i==6)
            xlabel('\gamma','FontSize', 14);
        elseif(i==7)
            xlabel('T_{L \rightarrow D} (\tau_i)','FontSize', 14);
        end
    end
    subplot(1,2,2)
    box on
    for j = 1:no_lhc_samples    
        hold on
        plot(variable_values(i,j), X2_medians(j),'k*','MarkerSize', 9')
        ylabel('cell count','FontSize', 14);
        if(i==1)
            xlabel('\mu (hours)','FontSize', 14);
        elseif(i==2)
            xlabel('\sigma (hours)','FontSize', 14);
        elseif(i==3)
            xlabel('\Pi_{D-S} (%)','FontSize', 14);
        elseif (j==4)
            xlabel('\Theta_{D-S}','FontSize', 14);
        elseif(i==5)
            xlabel('EC_{50} (\muM)','FontSize', 14);
        elseif(i==6)
            xlabel('\gamma','FontSize', 14);
        elseif(i==7)
            xlabel('T_{L \rightarrow D} (\tau_i)','FontSize', 14);
        end
    end
    %suptitle('Correlation between output and input variable T_{L \rightarrow D}' );
end